<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="ks54team01.customer.transferBoard.mapper.CustomerTransferBoardMapper">

  	<!-- resultMap : 조회 결과를 자바 클래스(domain, dto)와 명시적으로 매핑 설정-->
  	<resultMap type="CustomerTransferBoard" id="transferBoardResultMap">
		<id column="transfer_board_no" property="transferBoardNum" />
		<result column="cust_id" property="customerId" />
		<result column="rental_contract_no" property="rentalContractNum" />
		<result column="sell_products_no" property="sellProductsNum" />
		<result column="model_no" property="modelNum" />
		<result column="item_no" property="itemNum" />
		<result column="product_category_no" property="productCategoryNum" />		
		<result column="del_info_no" property="deliveryInfoNum" />
		<result column="transfer_title" property="transferTitle" />
		<result column="transfer_content" property="transferContent" />
		<result column="rental_fee" property="rentalFee" />
		<result column="remaining_months" property="remainingMonths" />
		<result column="contract_end_date" property="contractEndDate" />
		<result column="individual_grants" property="individualGrants" />
		<result column="board_valid_date" property="boardValidDate" />
		<result column="transfer_rental_processing_status" property="transferRentalProcsssingStatus" />
		<result column="register_date" property="registerDate" />
		<result column="revision_date" property="revisionDate" />


		<association property="productInfo" javaType="CustomerProduct">
			<id column="products_no" property="productsNum" />
			<result column="manager_id" property="managerId" />
			<result column="model_no" property="modelNum" />
			<result column="item_no" property="itemNum" />
			<result column="product_category_no" property="productCategoryNum" />
			<result column="products_nm" property="productsName" />
			<result column="products_status" property="productsStatus" />		
			<result column="products_image" property="productsImage" />
			<result column="register_date" property="registerDate" />
			<result column="revision_date" property="revisionDate" />
		</association>
  	</resultMap>	

  	<select id="getTransferBoardList" parameterType="CustomerTransferBoard" resultMap="transferBoardResultMap">
  		/* 양도 게시글 목록 조회 (제목, 작성자, 상품명, 이미지)*/
	   SELECT 
			p.products_image ,
			tb.cust_id ,
			tb.transfer_title ,
			tb.rental_fee ,
			tb.individual_grants ,
			tb.transfer_rental_processing_status ,
			tb.register_date 
		 FROM 
			transfer_board tb INNER JOIN sell_products sp 
			USING (sell_products_no) 
			INNER JOIN products p 
			USING (products_no);
  	</select>
  </mapper>